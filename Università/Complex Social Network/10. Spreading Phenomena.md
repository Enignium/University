La diffusione della **SARS** nel 2003. Tutto ebbe origine quando un medico della provincia cinese del Guangdong, già esposto a pazienti con una forma di “polmonite atipica”, si recò a Hong Kong e soggiornò al **Metropole Hotel**. In una sola notte, **infettò 16 ospiti e un visitatore**.  
Questi individui, ignari di essere contagiati, si spostarono poi verso Hanoi, Singapore e Toronto, dando origine a nuovi focolai. Gli epidemiologi scoprirono in seguito che **circa metà degli oltre 8.000 casi globali** di SARS potevano essere ricondotti a quella singola notte.

Il medico divenne così l’esempio perfetto di **super-spreader**, ovvero un individuo che genera un numero sproporzionato di contagi.  
Un teorico delle reti riconoscerebbe immediatamente questo comportamento: i super-spreader corrispondono ai **nodi hub**, quei nodi con **un numero eccezionalmente alto di connessioni** nel grafo dei contatti.
Proprio come gli hub determinano la struttura e la dinamica di molte reti (Internet, reti sociali, ecc.), i super-spreader determinano la propagazione delle malattie infettive.

![[Pasted image 20251104115240.png|400]]

Modellazione Epidemica

L’epidemiologia tradizionale si basa  su **due ipotesi fondamentali**: **compartimentalizzazione** e **mescolamento omogeneo**.

#### Compartimentalizzazione

L’idea centrale è classificare ogni individuo in base allo **stadio della malattia** che lo riguarda.  
Il modello più semplice, chiamato **SIR**, divide la popolazione in tre compartimenti:

- **S (Susceptible)** → individui **suscettibili**, sani ma non ancora entrati in contatto con il patogeno. All'inizio sarà uguale ad N

- **I (Infectious)** → individui **infetti e contagiosi**, in grado di trasmettere la malattia ad altri. Inizialmente sarà uguale a 0

- **R (Recovered)** → individui **guariti**, non più contagiosi e immuni a quel ceppo specifico.

Per cui avremo: $$S \xrightarrow{\text{infezione}} I \xrightarrow{\text{guarigione}} R$$
All’inizio di un’epidemia, quasi tutti gli individui sono suscettibili.  
Quando una persona entra in contatto con un infetto, può diventare a sua volta infetta, e successivamente guarire, acquisendo immunità.
##### Modello SI

La probabilità che la persona infetta colpisca una persona suscettibile è $\frac{S/t)}{N}$ . In ciò un individuo infetto viene a contatto con $\langle k \rangle * S(t)$ individui suscettibili in un'unità di tempo

Fino a quanto $I(t)$ individuo infetti trasmettono la patologia ad ogni rate $\beta$, il numero medio di infetti $dl(t)$ che compare in un intervallo di tempo $dt$ è: $$dI(t)=\beta*\langle k\rangle*I(t)*\frac{S(t)}{N}*dt$$
cioè **proporzionale** al numero di infetti presenti, al numero medio di contatti ⟨k⟩ e alla probabilità che ciascun contatto avvenga con un individuo suscettibile $\frac{S(t)}{N}$.

Dinamica:

Ogni infetto ha $\langle k \rangle$ contatti/unità di tempo; la frazione di suscettibili è $\frac{S}{N}$; la probabilità di trasmissione per contatto è $\beta$. Possiamo quindi scrivere: $$\frac{dI}{dt}= \beta*\langle k\rangle*I*\frac{S}{N}$$ e $$\frac{dS}{dt}= -\beta*\langle k \rangle* I* \frac{S}{N}$$
Definendo le frazioni $i(t)=\frac{I}{N}$ e $s(t)= \frac{S}{N}$ con $s=1-i$ . 

Si avrà:$$\frac{di}{dt}=\beta*\langle k \rangle* i*s=\beta*\langle k\rangle*i*(1-i)$$
E' quindi possibile dividere le variabili: $$\frac{di}{i*(1-i)}= =\beta*\langle k \rangle*dt \rightarrow ln\frac{i}{i-1}= \beta*\langle k \rangle*t+C$$
con $i(0) O i_0$ si ottiene $C=ln\frac{i_0}{1-i_0}$.

Quindi: $$\dot{i}(t) = \frac{1}{1 + \frac{1-\dot{i}_0}{\dot{i}_0} e^{-\beta \langle k \rangle t}} = \frac{\dot{i}_0 e^{\beta \langle k \rangle t}}{1 - \dot{i}_0 + \dot{i}_0 e^{\beta \langle k \rangle t}}$$
La frazione di suscettibilità è $s(t)=1-i(t)$

Proprietà:

- Fase iniziale (crescita esponenziale):
$i(t) = i_0*e^{\beta*\langle k \rangle*t}$

- Tempo caratteristico:
$\tau=\frac{1}{\beta*\langle k \rangle}$

Inverso della velocità di propagazione

- Saturazione:
per $t \to \infty$, $i(t) \to 1$ e $s(t) \to 0$ (tutta la popolazione viene infettata)

![[Pasted image 20251104123051.png|400]]

Dalla figura possiamo osservare il modello SI:

Figura a, ogni individuo può trovarsi in due soli stati, S e I. Il processo di infezione avviene con tasso $\beta$

Dalla figura b possiamo osservare l'evoluzione temporale:

- Fase iniziale (regime esponenziale)
quando gli infetti sono pochi, ciascuno entra quasi sempre in contatto con suscettibili, avremo: $$i(t)=i_0*e^{\beta*\langle k\rangle*t}$$
- Fase di saturazione:
man mano che gli infetti aumentano, i suscettibili diminuiscono e le probabilità di contagio si riducono. A $t \to \infty$ si avrà: $$i(t) \to 1 $$ e $$\frac{di}{dt} \to 0$$
Tutta la popolazione risulta infetta e l'epidemia si arresta

Il modello SI descrive malattie che non prevedono guarigione o immunità (ad esempio infezioni croniche o processi di diffusione irreversibili).

##### Modello SIS

Il modello **SIS** estende il modello **SI** introducendo la possibilità di **guarigione**.  
Nella realtà, infatti, la maggior parte dei patogeni viene prima o poi eliminata dall’organismo o curata, quindi gli individui infetti smettono di trasmettere la malattia e tornano suscettibili.

Dinamica:

Il modello avrà sempre due stati S ed I. La novità è che un individuo può guarire con un tasso di recupero $\mu$, tornando suscettibile. Avremo quindi: $$S \xrightarrow{\text{infezione}} I \xrightarrow{\text{guarigione}} S$$
Partendo dall'equazione del modello SI e aggiungendo il termine di recupero, si ottiene: $$\frac{di}{dt}= \beta*\langle k \rangle*i(1-i)-\mu*i$$
dove:

$\beta*\langle k \rangle*i(1-i)$ rappresenta i nuovi contagi;

$\mu*i$ rappresenta i guariti per unità di tempo

La soluzione dipende dalla forma della curva logistica modificata, in cui la crescita iniziale può essere frenata o annulata a seconda del valore del rapporto tra i due tassi $\beta*\langle k \rangle$ e $\mu$
Il sistema quindi evolverà in:

- Stato endemico ($\mu < \beta*\langle k \rangle$)
La malattia persiste stabilmente nella popolazione, senza infettare tutti. Il numero di infetti tende a un valore costante $i(\infty) < 1$, ottenuto imponendo $\frac{di}{dt}=0$: $$i(\infty) = 1- \frac{\mu}{\beta*\langle k \rangle}$$
A regime i nuovi infetti bilanciano esattamente i guariti $\to$ l'epidemia è stazionaria ma non scompare. Rappresenta quindi una malattia endemica.

- Stato disease-free ($\mu > \beta*\langle k \rangle$)
Se il tasso di guarigione è elevato, l'esponente nella soluzione diventa negativo. Gli infetti diminuiscono esponenzialmente nel tempo: $$i(t) = e^{-(\mu-\beta*\langle k \rangle)*t}$$
La malattia si estingue perchè i guariti superano i nuovi infetti

Si definisce **Numero riproduttivo di base**: $$R_0= \beta*{\langle k\rangle}{\mu}$$
In cui:

$R_0$ rappresenta il numero medio di nuovi contagi causati da un singolo infetto in una popolazione completamente suscettibile. E' un indicatore fondamentale per valutare la capacità di diffusione di un patogeno.
Se $R_0 > 1 \to$ ogni infetto contagia più di una persona $\to$ l'infezione si diffonde (endemico)
Se $R_0 < 1 \to$ ogni infetto contagia meno di una persona $\to$ la malattia scompare (libero dalla malattia)
Il parametro associato al ritmo temporale di diffusione è: $$\tau = \frac{1}{\mu-\beta*\langle k \rangle}$$
positivo nello stato endemico e negativo nello stato libero della malattia.

![[Pasted image 20251104144856.png|350]]

Dalla figura a possiamo osservare i due stati considerati, S e I. Il processo dinamico prevede l'infezione con tasso $\beta$ e guarigione con tasso $\mu$. 

Dalla figura b si può osservare la frazione di infetti $i(t)$ nel tempo:

- Fase iniziale (exponential outbreak)
Quando $i$ è piccolo, la diffusione cresce esponenzialmente: $$i(t) = i_0*e^{(\beta*\langle k \rangle-\mu)*t}$$
Se il termine $\beta*\langle k \rangle-\mu > 0$, la malattia si espande

- Fase finale (Stato endemico)
Con il passare del tempo si raggiunge un equilibrio dinamico in cui: $$i(\infty) = 1-\frac{\mu}{\beta*\langle k \rangle}$$
cioè una **frazione costante** della popolazione resta infetta: nuovi contagi e guarigioni si bilanciano.  
È la **condizione endemica**: la malattia non scompare ma persiste nel tempo.

Se invece la guarigione è molto rapida ($\mu > \beta*\langle k \rangle$), allora $i(t)$ decresce esponenzialmente e l'epidemia si estingue.
##### Modello SIR


#### Mescolamento omogeneo

Questa ipotesi, anche detta **mass-action approximation**, semplifica drasticamente il problema:  

si assume che **tutti gli individui abbiano la stessa probabilità di entrare in contatto tra loro**. Il modello ignora la struttura reale della rete di contatti e considera la popolazione come un sistema in cui chiunque può infettare chiunque.

Questa semplificazione permette di scrivere equazioni differenziali che descrivono l’evoluzione di $S(t), I(t), R(t)$ nel tempo, ma non tiene conto delle differenze individuali nei comportamenti o nei collegamenti sociali (per esempio la presenza di hub o super-spreader).

### Modello SIR

Si introduce un’evoluzione più realistica per molte malattie infettive, come l’influenza stagionale o il morbillo, in cui chi guarisce **sviluppa immunità** permanente (almeno contro quello specifico ceppo).

Gli individui possono trovarsi in **tre stati distinti**:

- **S (Susceptible)** → individuo sano, può contrarre la malattia.

- **I (Infected)** → individuo infetto e contagioso, capace di trasmettere il patogeno.

- **R (Recovered)** → individuo guarito, **rimosso** dal ciclo epidemico: non si può reinfettare e non trasmette più la malattia.

Avremo quindi: $$S \xrightarrow{\text{infezione}} I \xrightarrow{\text{guarigione}} R$$
Dinamica:

1)  Un suscettibile che entra in contatto con un infetto si ammala con probabilità proporzionale al **tasso di contagio $\beta$**.

 2) Gli infetti guariscono con **tasso di recupero $\mu$** e passano allo stato R.
    
- Gli individui “rimossi” (Recovered) non rientrano nel gruppo dei suscettibili, quindi **la popolazione attiva (S + I)** diminuisce nel tempo.

Le equazioni differenziali che governano l'evoluzione nel tempo dello stato saranno: $$
\begin{cases}
\frac{dS}{dt} = -\beta \langle k \rangle S \frac{I}{N} \\
\frac{dI}{dt} = \beta \langle k \rangle S \frac{I}{N} - \mu I \\
\frac{dR}{dt} = \mu I
\end{cases}$$
- Avremo che il primo termine rappresenta i nuovi contagi
- Il secondo descrive i guariti (che smettono di contagiare)

![[Pasted image 20251110092418.png|450]]

Come si vede dalla figura c, all’inizio $S \approx N$, quindi la diffusione è **esponenziale** come nei modelli precedenti. Col tempo, S diminuisce perché sempre più individui passano a R; di conseguenza il tasso di nuovi contagi cala. Si raggiunge un **picco di infetti $I_{max}$** dopo il quale i guariti superano i nuovi casi e l’epidemia **si spegne** spontaneamente. A lungo termine, rimane una frazione significativa della popolazione immune (R), mentre il numero di infetti tende a zero: $$I(t \rightarrow \infty) = 0,\ R(t \rightarrow \infty)=R_\infty < 1$$
![[Pasted image 20251110093055.png|500]]

I modelli SI, SIS e SIR descrivono tre diversi modi in cui un’epidemia può evolvere nel tempo, a seconda delle caratteristiche del patogeno.

1) All’inizio di un’epidemia, quando solo pochi individui sono infetti, tutti e tre i modelli forniscono lo stesso risultato: il numero di persone contagiate cresce in modo esponenziale. In questa fase iniziale, infatti, gli individui infetti si trovano quasi sempre a contatto con soggetti ancora suscettibili, e il patogeno può diffondersi liberamente nella popolazione.

2) Con il passare del tempo, però, le differenze tra i modelli diventano evidenti. Nel modello **SI**, che non prevede guarigione né immunità, l’infezione continua a propagarsi finché ogni individuo non è stato contagiato. Nel modello **SIS**, invece, le persone infette guariscono ma possono ammalarsi di nuovo: in questo caso la malattia può estinguersi, se la guarigione avviene rapidamente, oppure diventare endemica, mantenendo una frazione costante di individui infetti nel tempo. Il modello **SIR** descrive invece malattie che conferiscono immunità dopo la guarigione: la popolazione passa dallo stato di suscettibile a quello di infetto e infine a quello di rimosso, che comprende i guariti o i deceduti.

Il parametro chiave che determina quale di questi scenari si verificherà è il **numero riproduttivo di base**, indicato con $R_0$. Esso rappresenta il numero medio di nuovi contagi generati da un singolo infetto in una popolazione completamente suscettibile. Se $R_0>1$, ogni persona infetta trasmette la malattia a più di un individuo, e l’infezione tende a diffondersi. Se invece $R_0<1$, ogni infetto contagia meno di una persona in media, e l’epidemia è destinata a spegnersi naturalmente.

Tutti questi modelli, tuttavia, condividono un’importante semplificazione: assumono che ogni individuo possa entrare in contatto con chiunque altro con la stessa probabilità, ipotesi nota come **mescolamento omogeneo**. Nella realtà questo non accade, poiché le persone interagiscono soltanto con un numero limitato di individui, all’interno di reti sociali o fisiche che definiscono i loro contatti. Alcune persone, inoltre, hanno molti più legami di altre: sono gli **hub** o “super-spreader”, capaci di influenzare in modo decisivo la diffusione della malattia. Per prevedere con maggiore precisione l’andamento reale di un’epidemia, diventa quindi necessario abbandonare l’ipotesi di mescolamento omogeneo e considerare esplicitamente la **rete dei contatti** su cui la malattia si propaga.

_HA FATTO VEDERE L'IMPLEMENTAZIONE IN PYTHON_

## Network epidemic

Le **prime versioni dei modelli epidemici (SI, SIS, SIR)** assumevano un’ipotesi di **mescolamento omogeneo**: ogni individuo poteva teoricamente infettare qualsiasi altro e tutti avevano lo stesso numero medio di contatti $\langle k \rangle$.  
Tuttavia, questa ipotesi è **irrealistica**, perché nella realtà le persone possono contagiare **solo i propri vicini di rete** e i **network di contatto** hanno **struttura complessa**, spesso **scale-free**, dove $\langle k \rangle$ non basta a descrivere la topologia. Questa consapevolezza ha portato a una **rivoluzione nei modelli epidemiologici**, avviata nel 2001 da **Romualdo Pastor-Satorras e Alessandro Vespignani**, che integrarono in modo coerente la **topologia delle reti** all’interno dei modelli di epidemia, dando origine al **formalismo delle network epidemics**.

### Modello SI nei network

Quando la diffusione avviene **su una rete**, i nodi con più connessioni (cioè con **grado k più alto**) hanno una **maggiore probabilità di entrare in contatto con individui infetti**. Per rappresentare questo fenomeno, si introduce il **degree block approximation**, che **raggruppa i nodi in classi di grado** e assume che i nodi con lo stesso grado si comportino **in modo statisticamente equivalente**.
Si indica con: $$i_k=\frac{I_k}{N_k}$$
la frazione di nodi infetti con grado k tra tutti i nodi di grado k
La frazione totale di nodi infetti nella rete è quindi: $$i=\sum_k p_k \cdot i_k$$
dove $p_k$ è la probabilità che un nodo abbia grado k.

L’equazione che descrive il **modello SI su una rete** è: $$\frac{di_k}{dt}= \beta \cdot (1-i_k)\cdot k\cdot \Theta_k$$
dove:

- $\beta$ è la probabilità di trasmissione del contagio per contatto
- $(1-i_k)$ rappresenta la frazione di nodi di grado k non ancora infetti
- k indica quante possibili connessioni può avere ciascun nodo

Rispetto al modello classico si avrà:

- $\langle k \rangle$ viene sostituito dal grado effettivo di ciascun nodo $k$
- $\Theta_k$ non coincide più con la frazione totale di infetti i, ma dipende dal grado e dal tempo $\rightarrow$ cattura la struttura locale della reinfettare
- Il sistema non è più descritto da una sola equazione differenziale, ma da un insieme di $k_{max}$ equazioni accoppiate

![[Pasted image 20251110103339.png|450]]

Dalla figura si può osservare il comportamento della _degree block approximation_ in cui viene rappresentato un’evoluzione dei modelli epidemiologici tradizionali. Nei modelli classici come SI, SIS o SIR, gli individui vengono semplicemente divisi in base al loro stato: suscettibili, infetti o guariti. Tuttavia, questa classificazione non tiene conto delle differenze strutturali della rete di contatti su cui l’epidemia si diffonde. Per colmare questa lacuna, il degree block approximation introduce un livello aggiuntivo di organizzazione. Oltre a suddividere la popolazione in compartimenti in base allo stato, raggruppa anche i nodi in base al **numero di connessioni**, cioè al **grado**. In questo modo, tutti gli individui che hanno lo stesso numero di collegamenti vengono considerati come appartenenti allo stesso gruppo, o “blocco”.

*L’idea di fondo è che i nodi con lo stesso grado si comportano in modo statisticamente simile: un individuo con 2 contatti ha una probabilità di contagio diversa da uno che ne ha 10, ma all’interno del gruppo dei nodi con grado 10, il comportamento medio può essere considerato equivalente.

Questo approccio permette di scrivere un’**equazione differenziale per ogni gruppo di grado**, invece di una sola per l’intera popolazione, come accadeva nei modelli omogenei. In tal modo, si riesce a descrivere la dinamica dell’infezione in modo più realistico, tenendo conto del fatto che non tutti gli individui hanno la stessa quantità di contatti.

All’interno di ciascun blocco, gli individui possono trovarsi in stati diversi: alcuni possono essere **suscettibili** (rappresentati da cerchi vuoti), altri **infetti** (cerchi pieni). Quindi, il degree block approximation **non sostituisce** la suddivisione classica in compartimenti epidemiologici, ma la **integra**, aggiungendo un’informazione strutturale sulla rete.

#### Caso nelle Random Network

Nel caso di una **rete casuale**, come quella descritta dal modello di **Erdős–Rényi**, il numero di connessioni per nodo è distribuito in modo abbastanza uniforme: la maggior parte dei nodi ha un numero di collegamenti vicino al valore medio $\langle k \rangle$, e le differenze tra i nodi sono minime.

In questo contesto, si può approssimare il secondo momento della distribuzione dei gradi con la relazione $\langle k² \rangle = \langle k \rangle \cdot (\langle k \rangle + 1)$. Inserendo questa espressione nella formulazione generale del modello SI su rete, si ottiene una forma molto semplice per il **tempo caratteristico dell’epidemia**, indicato con $\tau$: $$\tau^{SI}_{ER}=\frac{1}{\beta \cdot \langle k \rangle}$$
Questo risultato mostra che, in una rete omogenea, la velocità con cui l’infezione si propaga dipende unicamente dal tasso di trasmissione β e dal numero medio di contatti $\langle k \rangle$.

Di fatto, la struttura della rete in questo caso non altera in modo significativo la dinamica della diffusione: il comportamento ottenuto è lo stesso di quello previsto dai modelli epidemiologici classici basati sull’ipotesi di **mescolamento omogeneo**.  
In altre parole, quando tutti i nodi hanno circa lo stesso numero di connessioni, la rete si comporta come una popolazione perfettamente miscelata, e il contagio si diffonde in modo uniforme con un tempo caratteristico inversamente proporzionale alla probabilità di contagio e al numero medio di contatti.